{"version":3,"sources":["packageSolution/packageSolution/xmlGenerators/createComponentXml.ts"],"names":[],"mappings":"AAAA;;;;;GAKG;AACH,mCAAmC;;;AAEnC,2BAA6B;AAC7B,kCAAoC;AAEpC,yDAAoD;AAGpD,+DAA0D;AAE1D,4BAA2C,OAAmB,EAAE,SAAiB;IAC/E,IAAM,UAAU,GAAO;QACnB,IAAI,EAAE,OAAO,CAAC,IAAI;QAClB,EAAE,EAAE,OAAO,CAAC,EAAE;QACd,iBAAiB,EAAE,OAAO,CAAC,QAAQ;KACtC,CAAC;IAEF,EAAE,CAAC,CAAC,OAAO,CAAC,oBAAoB,CAAC,CAAC,CAAC;QACjC,6CAA6C;QAC7C,UAAU,CAAC,8BAA8B,CAAC,GAAG,CAAC,OAAO,CAAC,oBAAoB,CAAC;IAC7E,CAAC;IAED,EAAE,CAAC,CAAC,OAAO,CAAC,IAAI,KAAK,uBAAa,CAAC,WAAW;QAC1C,OAAO,CAAC,IAAI,KAAK,uBAAa,CAAC,SAAS,CAAC,CAAC,CAAC;QAE7C,IAAM,IAAI,GAAW,OAAO,CAAC,IAAI,KAAK,uBAAa,CAAC,WAAW;cAC3D,aAAa,GAAG,WAAW,CAAC;QAEhC,6CAA6C;QAC7C,UAAU,CAAC,MAAM,CAAC,GAAG,IAAI,CAAC;QAE1B,MAAM,CAAC;YACL,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,EAAK,IAAI,SAAI,OAAO,CAAC,EAAE,SAAM,CAAC;YACjE,GAAG,EAAE,YAAY,CAAC;gBAChB,QAAQ,EAAE;oBACR;wBACE,mBAAmB,EAAE;4BACnB;gCACE,KAAK,EAAE,UAAU;6BAClB;yBACF;qBACF;oBACD;wBACE,KAAK,EAAE;4BACL,KAAK,EAAE,0CAA0C;yBAClD;qBACF;iBACF;aACF,EAAE,8BAAoB,CAAC;SACzB,CAAC;IACJ,CAAC;IAAC,IAAI,CAAC,CAAC;QACN,6CAA6C;QAC7C,UAAU,CAAC,MAAM,CAAC,GAAG,SAAS,CAAC;QAE/B,mEAAmE;QACnE,MAAM,CAAC;YACL,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,EAAE,aAAW,OAAO,CAAC,EAAE,SAAM,CAAC;YACjE,GAAG,EAAE,YAAY,CAAC;gBAChB,QAAQ,EAAE;oBACR;wBACE,mBAAmB,EAAE;4BACnB;gCACE,KAAK,EAAE,UAAU;6BAClB;yBACF;qBACF;oBACD;wBACE,MAAM,EAAE,YAAY,CAAC,SAAS,EAAE,OAAO,CAAC;qBACzC;oBACD;wBACE,KAAK,EAAE;4BACL,KAAK,EAAE,0CAA0C;yBAClD;qBACF;iBACF;aACF,EAAE,8BAAoB,CAAC;SACzB,CAAC;IACJ,CAAC;AACH,CAAC;AApED,qCAoEC;AAED;;GAEG;AACH,kCAAkC;AAClC,sBAAsB,SAAiB,EAAE,SAAqB;IAC5D,kCAAkC;IAClC,IAAM,MAAM,GAAU,CAAC;YACrB,KAAK,EAAE;gBACL,IAAI,EAAE,SAAS,CAAC,IAAI;gBACpB,GAAG,EAAE,cAAc;gBACnB,IAAI,EAAE,KAAK;aACZ;SACF,CAAC,CAAC;IAEH,MAAM,CAAC,MAAM,CAAC;AAChB,CAAC","file":"packageSolution/packageSolution/xmlGenerators/createComponentXml.js","sourcesContent":["/**\r\n * @file createComponentXml.ts\r\n * @Copyright (c) Microsoft Corporation.  All rights reserved.\r\n *\r\n * Creates an package's Element.Xml for a WebPart or ClientSideSolution\r\n */\r\n/// <reference path='./xml.d.ts' />\r\n\r\nimport * as path from 'path';\r\nimport * as XmlGenerator from 'xml';\r\n\r\nimport componentType from '../models/ComponentType';\r\nimport IComponent from '../models/packageDefinition/IComponent';\r\nimport IXml from '../models/packageXml/IXml';\r\nimport serializationOptions from './serializationOptions';\r\n\r\nexport default function createComponentXml(options: IComponent, featureId: string): IXml {\r\n  const attributes: {} = {\r\n      Name: options.name,\r\n      Id: options.id,\r\n      ComponentManifest: options.manifest\r\n  };\r\n\r\n  if (options.requiresCustomScript) {\r\n    // tslint:disable-next-line:no-string-literal\r\n    attributes['ReturnIfCustomScriptDisabled'] = !options.requiresCustomScript;\r\n  }\r\n\r\n  if (options.type === componentType.Application ||\r\n      options.type === componentType.Extension) {\r\n\r\n    const type: string = options.type === componentType.Application\r\n      ? 'Application' : 'Extension';\r\n\r\n    // tslint:disable-next-line:no-string-literal\r\n    attributes['Type'] = type;\r\n\r\n    return {\r\n      filename: path.posix.join(featureId, `${type}_${options.id}.xml`),\r\n      xml: XmlGenerator({\r\n        Elements: [\r\n          {\r\n            ClientSideComponent: [\r\n              {\r\n                _attr: attributes\r\n              }\r\n            ]\r\n          },\r\n          {\r\n            _attr: {\r\n              xmlns: 'http://schemas.microsoft.com/sharepoint/'\r\n            }\r\n          }\r\n        ]\r\n      }, serializationOptions)\r\n    };\r\n  } else {\r\n    // tslint:disable-next-line:no-string-literal\r\n    attributes['Type'] = 'WebPart';\r\n\r\n    // @todo Note that the options.id is NOT necessarily the feature ID\r\n    return {\r\n      filename: path.posix.join(featureId, `WebPart_${options.id}.xml`),\r\n      xml: XmlGenerator({\r\n        Elements: [\r\n          {\r\n            ClientSideComponent: [\r\n              {\r\n                _attr: attributes\r\n              }\r\n            ]\r\n          },\r\n          {\r\n            Module: createModule(featureId, options)\r\n          },\r\n          {\r\n            _attr: {\r\n              xmlns: 'http://schemas.microsoft.com/sharepoint/'\r\n            }\r\n          }\r\n        ]\r\n      }, serializationOptions)\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * Creates a Module xml element with all the files.\r\n */\r\n// tslint:disable-next-line:no-any\r\nfunction createModule(featureId: string, component: IComponent): any {\r\n  // tslint:disable-next-line:no-any\r\n  const result: any[] = [{\r\n    _attr: {\r\n      Name: component.name,\r\n      Url: '_catalogs/wp',\r\n      List: '113'\r\n    }\r\n  }];\r\n\r\n  return result;\r\n}"],"sourceRoot":"..\\..\\..\\..\\src"}